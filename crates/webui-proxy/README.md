# Webui proxy
This is a webhook endpoint component that:
* serves static files of `webui` package generated by `trunk dist`
* proxies `/api` requests to the `TARGET_URL`, the gRPC endpoint of Obelisk.

## Running in obelisk
The component is automatically loaded when `obelisk.toml` contains:
```toml
webui.listening_addr = "127.0.0.1:8080"
```
However, this loads the webui as specified in [webui-version.txt](../../assets/webui-version.txt).

Build
```sh
trunk --log=debug --offline build --config crates/webui/Trunk.toml
cargo build --package webui-proxy --target=wasm32-wasip2 --profile=release_trunk
```

Add the `webui-proxy` as a webhook endpoint:
```toml
[[http_server]]
name = "webui2"
listening_addr = "127.0.0.1:8082"

[[webhook_endpoint]]
name = "webui2"
http_server = "webui2"
location.path = "target/wasm32-wasip2/release_trunk/webui_proxy.wasm"
routes = [""]
env_vars = ["TARGET_URL=http://127.0.0.1:5005"]
forward_stdout = "stderr"
forward_stderr = "stderr"
```

## Pushing to docker hub
See [webui-bump.sh](../../scripts/push-webui.sh).
